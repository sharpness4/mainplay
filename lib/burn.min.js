(function (globalNamespace) {
  var devToolsDetection = devToolsDetection || {};

  function detectDevTools(callback) {
    if (typeof callback === "function") {
      let isDevToolsOpen = false;

      function checkDevToolsStatus() {
        isDevToolsOpen = false;

        // Verifica se o Firebug está aberto
        if (window.Firebug && window.Firebug.chrome && window.Firebug.chrome.isInitialized) {
          isDevToolsOpen = true;
        } else {
          var testImage = new Image();
          testImage.__defineGetter__('id', function () {
            isDevToolsOpen = true;
          });

          console.log(testImage);

          var widthDifference = window.outerWidth - window.innerWidth > 160;
          var heightDifference = window.outerHeight - window.innerHeight > 160;

          if (!(heightDifference && widthDifference || !widthDifference && !heightDifference)) {
            isDevToolsOpen = true;
          }

          if (!isDevToolsOpen) {
            var startTime = new Date().getTime();
            
            // Executa uma operação de eval de forma ofuscada para tentar enganar a detecção
            eval(function (code, a, b, c, d, e) {
              e = String;
              if (!''.replace(/^/, String)) {
                for (; b--;) {
                  d[b] = c[b] || b;
                }
                c = [function (index) {
                  return d[index];
                }];
                e = function () {
                  return "\\w+";
                };
                b = 1;
              }
              for (; b--;) {
                if (c[b]) {
                  code = code.replace(new RegExp("\\b" + e(b) + "\\b", 'g'), c[b]);
                }
              }
              return code;
            }('0;', 0, 1, "debugger".split('|'), 0, {}));

            var endTime = new Date().getTime();
            if (endTime - startTime > 100) {
              isDevToolsOpen = true;
            }
          }
        }

        console.clear();
        callback(isDevToolsOpen);
      }

      checkDevToolsStatus();
      setInterval(checkDevToolsStatus, 1000);
      window.addEventListener("resize", checkDevToolsStatus);
    }
  }

  devToolsDetection.detect = detectDevTools;

  // Verifica se a função define está disponível (usada em AMD ou CMD)
  if (typeof define === "function") {
    if (define.amd || define.cmd) {
      define(function () {
        return devToolsDetection;
      });
    }
  } else if (typeof module !== "undefined" && module.exports) {
    module.exports = devToolsDetection;
  } else {
    window[globalNamespace] = devToolsDetection;
  }
})('devtools');
